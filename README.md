# ๐ ะขะตัะฝััะฝะต ะทะฐะฒะดะฐะฝะฝั โ NutriScan AI-ัะตัะฒัั

ะะตัะฐ: ะะพะทัะพะฑะธัะธ ะปะพะบะฐะปัะฝะธะน AI-ัะตัะฒัั ะฝะฐ Ubuntu 22.04, ัะบะธะน:

1. ะัะธะนะผะฐั ัะพัะพ ัััะฐะฒะธ ัะตัะตะท API
2. ะะธะทะฝะฐัะฐั ัะฝะณัะตะดััะฝัะธ
3. ะััะฝัั ะผะฐัั (ะฒะฐะณั)
4. ะะพะทัะฐัะพะฒัั ะบะฐะปะพััะนะฝัััั ั ะผะฐะบัะพะตะปะตะผะตะฝัะธ (ะะะฃ)
5. ะะพะฒะตััะฐั JSON-ะฒัะดะฟะพะฒัะดั

## ๐งน ะัะฐะฟ 1: ะกัะฒะพัะตะฝะฝั ะฑะฐะทะพะฒะพะณะพ API

๐ ะะตัะฐ
ะะฐะปะฐัััะฒะฐัะธ FastAPI-ัะตัะฒะตั, ัะบะธะน ะฟัะธะนะผะฐั POST-ะทะฐะฟะธั ะท ัะพัะพ.

๐ ะััะด
POST /upload/ ะท multipart/form-data, ะฟะพะปะต image

๐ ะะธััะด

```
{ "message": "Image received", "filename": "some_image.jpg" }
```

๐ ะะฝััััะผะตะฝัะธ

* FastAPI
* Pydantic
* Uvicorn

โ ะัะธัะตััั ะทะฐะฒะตััะตะฝะฝั

* ะกะตัะฒะตั ะทะฐะฟััะบะฐััััั
* ะคะพัะพ ะฟัะธะนะผะฐััััั ัะฐ ะทะฑะตััะณะฐััััั ะฒ ัะธะผัะฐัะพะฒัะน ะฟะฐะฟัั
* ะะฐะฟะธัะฐะฝะพ ะฐะฒัะพัะตัั: test\_upload.py

## ๐งน ะัะฐะฟ 2: ะะธะทะฝะฐัะตะฝะฝั ัะฝะณัะตะดััะฝััะฒ

๐ ะะตัะฐ
ะะพะทัะพะฑะธัะธ/ะฟัะดะบะปััะธัะธ ะผะพะดะตะปั ะดะปั ะดะตัะตะบััั ัะฝะณัะตะดััะฝััะฒ ะฝะฐ ัะพัะพ.

๐ ะััะด
ะคะพัะพ ัััะฐะฒะธ

๐ ะะธััะด

```
{
  "ingredients": [
    {"name": "potato", "confidence": 0.88},
    {"name": "carrot", "confidence": 0.81}
  ]
}
```

๐ ะะฝััััะผะตะฝัะธ

* ะะพะดะตะปั ะดะตัะตะบััั: YOLOv5/YOLOv8/Detic/AnyLabel
* Torch / Transformers
* OpenCV

โ ะัะธัะตััั ะทะฐะฒะตััะตะฝะฝั

* ะะพะดะตะปั ะฟัะฐััั ะปะพะบะฐะปัะฝะพ
* ะขะตัั ะฝะฐ ะพะดะฝะพะผั ัะพัะพ test\_ingredients.py

## ๐งน ะัะฐะฟ 3: ะะฝัะตะณัะฐััั API + ะะพะดะตะปั ัะฝะณัะตะดััะฝััะฒ

๐ ะะตัะฐ
ะคะพัะพ ะท API ะฟะตัะตะดะฐััััั ะฒ ะผะพะดะตะปั, ัะตะทัะปััะฐั ะฟะพะฒะตััะฐััััั ะบะพัะธัััะฒะฐัั.

๐ ะััะด
POST /detect/ ะท ัะพัะพ

๐ ะะธััะด

```
{
  "ingredients": [
    {"name": "potato", "confidence": 0.88},
    {"name": "carrot", "confidence": 0.81}
  ]
}
```

โ ะัะธัะตััั ะทะฐะฒะตััะตะฝะฝั

* ะะพะฒะฝะฐ ะฟะตัะตะดะฐัะฐ ะทะพะฑัะฐะถะตะฝะฝั ัะตัะตะท API ะฒ ะผะพะดะตะปั
* ะะฒัะพัะตัั test\_api\_detection.py

## ๐งน ะัะฐะฟ 4: ะััะฝะบะฐ ะผะฐัะธ ัะฝะณัะตะดััะฝััะฒ

๐ ะะตัะฐ
ะััะฝะธัะธ ะฟัะธะฑะปะธะทะฝั ะฒะฐะณั ัะฝะณัะตะดััะฝััะฒ ะฝะฐ ะพัะฝะพะฒั ัะพะทะผััั.

๐ ะััะด
ะคะพัะพ + bounding boxes ัะฝะณัะตะดััะฝััะฒ

๐ ะะธััะด

```
{
  "ingredients": [
    {"name": "carrot", "weight_g": 50},
    {"name": "potato", "weight_g": 100}
  ]
}
```

๐ ะะฝััััะผะตะฝัะธ

* ะะฒัะธััะธะบะฐ ะทะฐ ะฟะปะพัะตั ะพะฑ'ัะบัะฐ
* Kalman ะฐะฑะพ ัะตะณัะตััะนะฝะฐ ะผะพะดะตะปั (ะพะฟััะพะฝะฐะปัะฝะพ)

โ ะัะธัะตััั ะทะฐะฒะตััะตะฝะฝั

* ะะพะทัะฐััะฝะพะบ ะฒะฐะณะธ ะฟัะฐััั
* ะะฒัะพัะตัั test\_weight\_estimation.py

## ๐งน ะัะฐะฟ 5: ะะพะทัะฐััะฝะพะบ ะบะฐะปะพััะนะฝะพััั ั ะะะฃ

๐ ะะตัะฐ
ะะฐ ะพัะฝะพะฒั ะฝะฐะทะฒะธ ัะฝะณัะตะดััะฝััะฒ ั ะฒะฐะณะธ ัะพะทัะฐััะฒะฐัะธ ะบะฐะปะพััั, ะฑัะปะบะธ, ะถะธัะธ, ะฒัะณะปะตะฒะพะดะธ.

๐ ะััะด
JSON ะท ัะฝะณัะตะดััะฝัะฐะผะธ ัะฐ ะฒะฐะณะพั

๐ ะะธััะด

```
{
  "total": {
    "calories_kcal": 350,
    "protein_g": 12,
    "fat_g": 8,
    "carbs_g": 45
  }
}
```

๐ ะะฝััััะผะตะฝัะธ

* Open Food Facts API
* ะะตััะฒะฐะฝะฝั ะปะพะบะฐะปัะฝะพ (SQLite)

โ ะัะธัะตััั ะทะฐะฒะตััะตะฝะฝั

* ะะฐะฝั ะฟัะธัะพะดััั ะท OFF
* ะขะตัั ัะท ะฒัะดะพะผะธะผ ะฝะฐะฑะพัะพะผ ัะฝะณัะตะดััะฝััะฒ test\_nutrition\_calc.py

## ๐งน ะัะฐะฟ 6: ะะฝัะตะณัะฐััั ะฒััะพะณะพ ะบะพะฝะฒะตััะฐ

๐ ะะตัะฐ
ะะฑโัะดะฝะฐัะธ ะฒัั ะตัะฐะฟะธ ะฒ ะพะดะธะฝ API-ะตะฝะดะฟะพัะฝั /analyze/, ัะบะธะน ะฟัะธะนะผะฐั ัะพัะพ ั ะฟะพะฒะตััะฐั ััะฝะฐะปัะฝะธะน JSON.

๐ ะััะด
POST /analyze/ ะท ัะพัะพ

๐ ะะธััะด (ะฟัะธะบะปะฐะด):

```
{
  "ingredients": [
    { "name": "potato", "weight_g": 100, "calories_kcal": 77, "protein_g": 2, "fat_g": 0.1, "carbs_g": 17 },
    { "name": "carrot", "weight_g": 50, "calories_kcal": 20, "protein_g": 0.5, "fat_g": 0.1, "carbs_g": 4.7 }
  ],
  "total": {
    "calories_kcal": 97,
    "protein_g": 2.5,
    "fat_g": 0.2,
    "carbs_g": 21.7
  }
}
```

โ ะัะธัะตััั ะทะฐะฒะตััะตะฝะฝั

* ะัะต ะทัะฑัะฐะฝะพ ะฒ ะพะดะฝะต
* ะัะพะนะดะตะฝั ัะฝัะตะณัะฐััะนะฝั ัะตััะธ test\_full\_pipeline.py

## ๐ ะกัััะบัััะฐ ะฟัะพัะบัั NutriScan (v0.2)

```
nutriscan/
โโโ app/                       # ะัะฝะพะฒะฝะฐ ะปะพะณัะบะฐ FastAPI
โ   โโโ main.py               # ะขะพัะบะฐ ะฒัะพะดั FastAPI
โ   โโโ models/               # ะะพะดะตะปั ัะฝะณัะตะดััะฝััะฒ (YOLOv8 ัะฐ ัะฝ.)
โ   โ   โโโ detector.py
โ   โโโ services/             # ะะพะณัะบะฐ ะฟะพ ะฒะฐะณะฐะผ, ะะะฃ, ัะพัะพ
โ   โ   โโโ nutrition.py
โ   โโโ utils/                # ะะฑัะพะฑะบะฐ ะทะพะฑัะฐะถะตะฝั, ะดะพะฟะพะผัะถะฝะต
โ   โ   โโโ image_utils.py
โ   โโโ api/                  # ะะพััะธ
โ       โโโ routes.py
โ
โโโ tests/                    # Pytest ัะตััะธ ะฝะฐ ะฒัั ะตัะฐะฟะธ
โ   โโโ test_upload.py
โ   โโโ test_ingredients.py
โ   โโโ test_api_detection.py
โ   โโโ test_weight_estimation.py
โ   โโโ test_nutrition_calc.py
โ
โโโ models/                   # ะะฐะณะธ ะผะพะดะตะปะตะน (.pt, .bin ัะพัะพ)
โ   โโโ detector.pt
โ
โโโ scripts/                  # ะกะบัะธะฟัะธ ัะฝััะฐะปัััั/ะทะฐะฟััะบั
โ   โโโ install.sh            # ะััะฐะฝะพะฒะปะตะฝะฝั ะทะฐะปะตะถะฝะพััะตะน, ะผะพะดะตะปะตะน
โ   โโโ download_models.sh    # ะะฐะฒะฐะฝัะฐะถะตะฝะฝั ะฒะฐะณ
โ   โโโ run_server.sh         # ะะฐะฟััะบ FastAPI
โ
โโโ docs/                     # ะะพะบัะผะตะฝัะฐััั
โ   โโโ DEVLOG.md             # Dev-ะฑะปะพะณ ะฟะพ ะตัะฐะฟะฐั
โ   โโโ INSTALL.md            # ะะฝััััะบััั ะฒััะฐะฝะพะฒะปะตะฝะฝั
โ
โโโ .env                      # ะะผัะฝะฝั ัะตัะตะดะพะฒะธัะฐ (ัะบัะพ ะฟะพัััะฑะฝะพ)
โโโ requirements.txt
โโโ README.md
```


๐ ะะพะผะฐะฝะดะธ ะฝะฐ ะผะฐะนะฑััะฝั

| ะัั        | ะะพะผะฐะฝะดะฐ                            |
| ---------- | ---------------------------------- |
| ะะตัะตะทะฐะฟััะบ | `sudo systemctl restart nutriscan` |
| ะกัะพะฟ       | `sudo systemctl stop nutriscan`    |
| ะกัะฐััั     | `sudo systemctl status nutriscan`  |
| ะะพะณะธ       | `journalctl -u nutriscan -f`       |
