# üìò –¢–µ—Ö–Ω—ñ—á–Ω–µ –∑–∞–≤–¥–∞–Ω–Ω—è ‚Äî NutriScan

## üåü –ú–µ—Ç–∞

–°—Ç–≤–æ—Ä–∏—Ç–∏ –ª–æ–∫–∞–ª—å–Ω–∏–π AI-—Å–µ—Ä–≤—ñ—Å –Ω–∞ Ubuntu 22.04, —è–∫–∏–π:

1. –ü—Ä–∏–π–º–∞—î —Ñ–æ—Ç–æ —Å—Ç—Ä–∞–≤–∏ —á–µ—Ä–µ–∑ FastAPI
2. –ü–µ—Ä–µ–¥–∞—î –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è –¥–æ GPT-4 Vision (—á–µ—Ä–µ–∑ API OpenAI)
3. –û—Ç—Ä–∏–º—É—î —Ä–æ–∑–ø—ñ–∑–Ω–∞–Ω—ñ —ñ–Ω–≥—Ä—ñ–¥—ñ—î–Ω—Ç–∏ –∑ –≤–∞–≥–æ—é, –∫–∞–ª–æ—Ä—ñ—è–º–∏, –ë–ñ–£
4. –ü–æ–≤–µ—Ä—Ç–∞—î –∫–ª—ñ—î–Ω—Ç—É –≥–æ—Ç–æ–≤—É JSON-–≤—ñ–¥–ø–æ–≤—ñ–¥—å

---

## üîß –ï—Ç–∞–ø–∏ —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—ó

---

## üßπ –ï—Ç–∞–ø 1 ‚Äî –ë–∞–∑–æ–≤–∏–π FastAPI —Å–µ—Ä–≤–µ—Ä

### ‚úÖ –¶—ñ–ª—å

–ü–æ–±—É–¥—É–≤–∞—Ç–∏ —Å–µ—Ä–≤–µ—Ä, —è–∫–∏–π –ø—Ä–∏–π–º–∞—î –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è —á–µ—Ä–µ–∑ POST-–∑–∞–ø–∏—Ç.

### üóí –í—Ö—ñ–¥

```
POST /upload/
multipart/form-data
–ü–æ–ª–µ: image
```

### üìÑ –í–∏—Ö—ñ–¥

```json
{ "message": "Image received", "filename": "some_image.jpg" }
```

### üõ† –Ü–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏

* FastAPI, Pydantic
* Uvicorn
* Python 3.10+

### üîé –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞

* –°–µ—Ä–≤–µ—Ä –∑–∞–ø—É—Å–∫–∞—î—Ç—å—Å—è
* –ó–æ–±—Ä–∞–∂–µ–Ω–Ω—è –∑–±–µ—Ä—ñ–≥–∞—î—Ç—å—Å—è —É `tmp/`

---

## üßπ –ï—Ç–∞–ø 2 ‚Äî –°–∫—Ä–∏–ø—Ç –¥–ª—è –∑–∞–ø–∏—Ç—É –¥–æ OpenAI Vision

### ‚úÖ –¶—ñ–ª—å

–°—Ç–≤–æ—Ä–∏—Ç–∏ –æ–∫—Ä–µ–º—É —Ñ—É–Ω–∫—Ü—ñ—é `analyze_image_base64()`, —è–∫–∞:

* –æ—Ç—Ä–∏–º—É—î base64-–∫–∞—Ä—Ç–∏–Ω–∫—É
* –Ω–∞–¥—Å–∏–ª–∞—î —ó—ó –¥–æ GPT-4 Vision
* –ø–æ–≤–µ—Ä—Ç–∞—î —Å–∏—Ä–∏–π –≤–∏–≤—ñ–¥

### üóí –í—Ö—ñ–¥

```python
image_base64: str
```

### üìÑ –í–∏—Ö—ñ–¥

```json
{
  "raw_response": "–ù–∞ –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—ñ –≤–∏–¥–Ω–æ –∫—É—Ä—è—á–µ —Ñ—ñ–ª–µ (120–≥) —Ç–∞ –±—Ä–æ–∫–æ–ª—ñ (80–≥)..."
}
```

### üõ† –Ü–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏

* OpenAI SDK (–∞–±–æ `requests`)
* `.env` –∑ –∫–ª—é—á–µ–º `OPENAI_API_KEY`

### üîé –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞

* –í–∏–≤—ñ–¥ –∑ GPT-4 Vision –ø–æ–≤–µ—Ä—Ç–∞—î—Ç—å—Å—è

---

## üßπ –ï—Ç–∞–ø 3 ‚Äî –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü—ñ—è –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è –≤ base64

### ‚úÖ –¶—ñ–ª—å

–†–µ–∞–ª—ñ–∑—É–≤–∞—Ç–∏ —Ñ—É–Ω–∫—Ü—ñ—é `image_to_base64(image_path: str) -> str`

### üóí –í—Ö—ñ–¥

`image.jpg`

### üìÑ –í–∏—Ö—ñ–¥

```python
"data:image/jpeg;base64,/9j/4AAQSkZJRgABAQEAYABgAAD..."
```

### üîé –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞

* –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –ø–æ–≤–µ—Ä—Ç–∞—î —Ä–µ–∑—É–ª—å—Ç–∞—Ç base64 URL

---

## üßπ –ï—Ç–∞–ø 4 ‚Äî –û–±—Ä–æ–±–∫–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ GPT —Ç–∞ –ø–∞—Ä—Å–∏–Ω–≥ —É JSON

### ‚úÖ –¶—ñ–ª—å

–°—Ç–≤–æ—Ä–∏—Ç–∏ `parse_openai_response(text: str) -> dict`, —è–∫–∞ –ø–æ–≤–µ—Ä—Ç–∞—î:

```json
{
  "ingredients": [
    {
      "name": "chicken breast",
      "weight_g": 120,
      "calories_kcal": 198,
      "protein_g": 36,
      "fat_g": 4,
      "carbs_g": 0
    }
  ],
  "total": {
    "calories_kcal": 198,
    "protein_g": 36,
    "fat_g": 4,
    "carbs_g": 0
  }
}
```

### üîé –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞

* –û–ø—Ä–∞—Ü—å–æ–≤–∞–Ω–∏–π —Ç–µ–∫—Å—Ç –ø–æ–≤–µ—Ä—Ç–∞—î—Ç—å—Å—è —É JSON-—Ñ–æ—Ä–º–∞—Ç—ñ

---

## üßπ –ï—Ç–∞–ø 5 ‚Äî –Ü–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—è FastAPI + OpenAI Vision

### ‚úÖ –¶—ñ–ª—å

–î–æ–¥–∞—Ç–∏ —Ä–æ—É—Ç `/analyze/`, —è–∫–∏–π:

1. –ø—Ä–∏–π–º–∞—î –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è
2. –∫–æ–Ω–≤–µ—Ä—Ç—É—î —É base64
3. –≤—ñ–¥—Å–∏–ª–∞—î –¥–æ OpenAI Vision
4. –æ–±—Ä–æ–±–ª—è—î –≤—ñ–¥–ø–æ–≤—ñ–¥—å
5. –≤–∏–¥–∞—î JSON

### üóí –í—Ö—ñ–¥

```
POST /analyze/ –∑ image
```

### üìÑ –í–∏—Ö—ñ–¥ (JSON)

```json
{
  "ingredients": [
    {
      "name": "apple",
      "weight_g": 150,
      "calories_kcal": 78,
      "protein_g": 0.4,
      "fat_g": 0.3,
      "carbs_g": 20
    },
    {
      "name": "banana",
      "weight_g": 120,
      "calories_kcal": 105,
      "protein_g": 1.3,
      "fat_g": 0.3,
      "carbs_g": 27
    }
  ],
  "total": {
    "calories_kcal": 183,
    "protein_g": 1.7,
    "fat_g": 0.6,
    "carbs_g": 47
  }
}
```

### üîé –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞

* –ü–æ–≤–µ—Ä—Ç–∞—î—Ç—å—Å—è –∫–æ—Ä–µ–∫—Ç–Ω–∏–π JSON

---

## ü•Æ –ï—Ç–∞–ø 6 ‚Äî –õ–æ–≥—É–≤–∞–Ω–Ω—è, –æ–±—Ä–æ–±–∫–∞ –ø–æ–º–∏–ª–æ–∫, –∫–µ—à

### ‚úÖ –¶—ñ–ª—å

* –î–æ–¥–∞—Ç–∏ –ª–æ–≥—É–≤–∞–Ω–Ω—è —É—Å—ñ—Ö –∑–∞–ø–∏—Ç—ñ–≤
* –û–±—Ä–æ–±–ª—è—Ç–∏ –ø–æ–º–∏–ª–∫–∏ OpenAI/–≤—ñ–¥—Å—É—Ç–Ω—ñ –∫–ª—é—á—ñ
* (–û–ø—Ü—ñ–π–Ω–æ) –∫–µ—à—É–≤–∞–Ω–Ω—è –æ—Å—Ç–∞–Ω–Ω

---

## ü•Æ –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è —á–µ—Ä–µ–∑ curl
```bash
curl -X POST -F image=@dish.jpg http://localhost:8000/analyze/
```

üìÑ –õ—ñ—Ü–µ–Ω–∑—ñ—è
–¶–µ–π –ø—Ä–æ—î–∫—Ç –ø–æ—à–∏—Ä—é—î—Ç—å—Å—è –ø—ñ–¥ –ª—ñ—Ü–µ–Ω–∑—ñ—î—é MIT.

---

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ—î–∫—Ç—É:
```python
nutriscan/
‚îú‚îÄ‚îÄ app/
‚îÇ   ‚îú‚îÄ‚îÄ main.py
‚îÇ   ‚îî‚îÄ‚îÄ utils/
‚îú‚îÄ‚îÄ tmp/                ‚Üê –∑–±–µ—Ä—ñ–≥–∞–Ω–Ω—è –∑–æ–±—Ä–∞–∂–µ–Ω—å
‚îú‚îÄ‚îÄ requirements.txt    ‚Üê –æ–Ω–æ–≤–ª—é—î—Ç—å—Å—è –ø–æ—Å—Ç—É–ø–æ–≤–æ
```